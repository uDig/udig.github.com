
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Guide To EMF &mdash; uDig 2.0.0.RC1 Developers Guide</title>
    
    <link rel="stylesheet" href="_static/udig.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '2.0.0.RC1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="shortcut icon" href="_static/udig.ico"/>
    <link rel="top" title="uDig 2.0.0.RC1 Developers Guide" href="index.html" />
    <link rel="up" title="Reference" href="reference.html" />
    <link rel="next" title="Guide to MigLayout" href="guide_to_miglayout.html" />
    <link rel="prev" title="Fonts and Imagery" href="fonts_and_imagery.html" /> 
  </head>
  <body>
      <div class="header">
        <div class="wrap">
            <h1 id="logo"><a href="http://udig.refractions.net">uDig</a></h1>
            <ul id="top-nav">
                <li class="first">
                  <a href="http://udig.refractions.net">uDig Home</a>
                </li>
                <li>
                   <a href="http://udig.refractions.net/download">Downloads</a>
                </li>
                <li>
                   <a href="http://udig-news.blogspot.com">Blog</a>
                </li>
            </ul>
       </div>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="fonts_and_imagery.html">Fonts and Imagery</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="guide_to_miglayout.html">Guide to MigLayout</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="guide-to-emf">
<h1>Guide To EMF<a class="headerlink" href="#guide-to-emf" title="Permalink to this headline">¶</a></h1>
<p>The Eclipse Modeling Framework is amazing; but it is also hard to find useful documentation on. This
page covers some of our notes as we were learning EMF and should be a good starting point.</p>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>A short summary on how to use EMF - the basic work flow of using EMF is as follows:</p>
<ol class="arabic simple">
<li>Load an EMF model. Potential source of loading are the following:</li>
</ol>
<ul class="simple">
<li>Annotated Java interfaces</li>
<li>XML Schema</li>
<li>UML model</li>
</ul>
<ol class="arabic simple">
<li>Optional editing of the model with the EMF model editor</li>
<li>Generate code</li>
<li>Customize generated code</li>
<li>Repeat (after customizing model annotations you can &#8220;refresh&#8221; your model)</li>
</ol>
<p>If the source used to load the EMF model is not annotated Java interfaces then the generated
interfaces will be annotated Java interfaces and can be used at a later date to reload the model.</p>
<p>The methods that are generated by the EMF generator all have the javadoc annotation: &#64;generated.
This tag indicates that the method has been generated and will be regenerated in the future. The tag
must be changed in order for custom changes to be made to the method. If the annotation is not
changed then the changes will be lost. See <a class="reference external" href="#GuideToEMF-customMethods">How to Modify a Generated
Method</a>.</p>
<p>A second concern one should be aware of is that the methods that are generated also regenerate
comments during each generation. See <a class="reference external" href="#GuideToEMF-EMFComments">Adding Comments to EMF Generated
Methods</a> to understand how one can add comments to a generated method.</p>
</div>
<div class="section" id="id1">
<h2>Adding Comments to EMF Generated Methods<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>How to add(an not lose) custom Java docs....</p>
<p>It is important to realize that comments are generated in addition to method bodies. There are two
different ways to add comments to a method:</p>
<ol class="arabic">
<li><p class="first">Modify or remove the &#64;generated. If this strategy is used, remember that the method will no
longer be generated and model changes will not be made to that method. See <a class="reference external" href="#GuideToEMF-customMethods">How to Modify a
Generated Method</a></p>
</li>
<li><p class="first">Insert comments between the</p>
<div class="highlight-python"><pre>* &lt;!-- begin-user-doc --&gt;
* &lt;!-- end-user-doc --&gt;</pre>
</div>
<p>lines. Comments placed between these two lines will kept during code generation.</p>
</li>
</ol>
</div>
<div class="section" id="id3">
<h2>How to Modify a Generated Method<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>There are two ways that methods can be customized:</p>
<ol class="arabic simple">
<li>Delete or modify the &#64;generated tag. Replacing &#64;generated with &#64;generated NOT is the standard
way.
When the &#64;generated tag is replaced or modified the method will no longer be generated by the
EMF generator. The positive side of this is that customizations will not be lost. The negative
side is that changes to the model must be made by hand to the method rather than generated by the
EMF generator. For example, suppose that a method, setAttr, is the setter for an attribute that
notifies listeners when the attribute is changed. If a modification is made to the model that
indicates that the setter should not notify listeners then changes will have to be made manually
rather than generated. SolutionHow to Modify a Generated Method 2 overcomes this limitation.</li>
<li>The name of the generated method can changed to <em>name</em><strong>Gen</strong> (Gen is added to the end of the
method name) and the method is recreated manually without a &#64;generated tag. When this strategy is
used the EMF generator will generate to the method with Gen at the end and the custom
implementation will be unchanged. This allows the custom implementation to call the generated
implementation, thereby retaining the benefits of code generation.
Using the previous example if the method is changed to no longer raise notifications the new
code will replace the code in setAttrGen, rather than setAttr.</li>
</ol>
</div>
<div class="section" id="regenerating-model">
<h2>Regenerating Model<a class="headerlink" href="#regenerating-model" title="Permalink to this headline">¶</a></h2>
<p>To regenerate a model and code the following steps should be taken:</p>
<ol class="arabic simple">
<li>Right click on the .genmodel file and select Reload or select the .genmodel editor and select
Reload from the Generator menu.
Reloading a model recreates the model from one of the source mentioned in the
<a class="reference external" href="#GuideToEMF-EMFSummary">Summary</a> . If the code has been generated then regardless of what
source was originally used the generated Java interfaces can be used as a source.</li>
<li>Complete the wizard.</li>
<li>Select the generate option desired from the editor&#8217;s context menu or from the Generate menu.</li>
</ol>
<ul class="simple">
<li>&#8220;Generate Model Code&#8221; generates the model code only.</li>
<li>&#8220;Generate Edit Code&#8221; generates code that provides adapters and editing functionality.</li>
<li>&#8220;Generate Editor Code&#8221; generates the UI code for editing and viewing the model.</li>
<li>&#8220;Generate All&#8221; is equivalent to running all of the previous choices.</li>
</ul>
<p>Code generate will delete any customizations made to the code unless one of the steps in <a class="reference external" href="#GuideToEMF-customMethods">How to
Modify a Generated Method</a> is used.</p>
</div>
<div class="section" id="model-creation-with-annotated-java">
<h2>Model Creation with Annotated Java<a class="headerlink" href="#model-creation-with-annotated-java" title="Permalink to this headline">¶</a></h2>
<p>To create a model using annotated Java each method and class that is to be a model component must
have the &#64;model tag in its Javadocs. (If a class does not have the &#64;model tag then none of the
methods will be included in the model regardless of whether they have the &#64;model tag.) To create an
attribute provide a get method with a &#64;model tag. The model generator will generate a setter for the
attribute which will, by default, provide change notification if the attribute is changed. An
attribute can be a data attribute or a reference attribute. A reference attribute is an attribute
that refers to another object in the EMF model. A reference is more powerful in that it is an EMF
Object so containment relationship and bi-directional relationship can be generated from the model.
For example in a containment relationship an object can have only one container. The generator will
generate code so that when a object is added to a container it will be removed from its previous
contain automatically. There are a number of functions that the generated code can offer to
reference attributes that are not possible with data attributes. Many of the standard Java types
have EObject equivalents that are used automatically. For example a String attribute is by default
interpreted as a EString reference attribute.</p>
</div>
<div class="section" id="emf-annotations">
<h2>EMF Annotations<a class="headerlink" href="#emf-annotations" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="8%" />
<col width="56%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>&#64;model</td>
<td>Object</td>
<td>indicates this something real you want saved, not just another method</td>
</tr>
<tr class="row-even"><td>&#64;model type=&#8221;XXX&#8221;</td>
<td>List</td>
<td>indicates the List elements are of type XXX</td>
</tr>
<tr class="row-odd"><td>&#64;model transient=&#8221;true&#8221;</td>
<td>&nbsp;</td>
<td>don&#8217;t save</td>
</tr>
<tr class="row-even"><td>&#64;model dataType=&#8221;org.geotools.filter.Filter&#8221;</td>
<td>Filter</td>
<td>Use of custom datatype</td>
</tr>
<tr class="row-odd"><td>&#64;model serializable=&#8221;false&#8221;</td>
<td>?</td>
<td>?</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="emf-model-and-generator-editor">
<h2>EMF Model and Generator editor<a class="headerlink" href="#emf-model-and-generator-editor" title="Permalink to this headline">¶</a></h2>
<p>The EMF model and model generator are separated into one .genmodel file and a number of .ecore
files. The .ecore files specify the model itself and the .genmodel file specifies how the model will
be generated. Editors are provided for both .ecore files and .genmodel files. The .ecore editor
allows the attribute of each class, attribute and method to be modified using the properties view.
The properties view provides the list of possible options and a short tip is provided in the status
line.</p>
</div>
<div class="section" id="tips-and-tricks">
<h2>Tips and Tricks<a class="headerlink" href="#tips-and-tricks" title="Permalink to this headline">¶</a></h2>
<p><strong>How do save my model?</strong></p>
<p>A: Saving is largely automated in EMF. Each eObject can optionally be assigned to an eResource.
(eResource() obtains the resource for an object). If an object is <em>contained</em> by another object then
the <em>contained</em> object will have the same eResource as the containing resource. To save the model a
call to eResource.save(null) will save the EObject and all of its referenced EObjects. If the model
has multiple EObjects that are not declared as being contained then each of those objects must be
have been assigned to an eResource.</p>
<p><strong>How do I load my model?</strong></p>
<p>A: To load an EMF model, an eResource must be created that references the file containing the model.
A call to eResource.load(null) will load the model. However, all references to objects saved in
other files will be proxy objects until the references are accessed using a get or set method. At
that time the real object will be loaded.</p>
<p><strong>How can I extend a non-EMF interface?</strong></p>
<p>A: According to the EMF model all supertypes of an EObject must be EObjects. However there exists a
mechanism to declare normal non-EMF interfaces as EMF objects. For example, standard Java interfaces
(such as comparable) can be extended. An interface can be declared to be an EClass EMF objects can
be declared in the Package Interface and then can be used as a supertype.</p>
<p><strong>Example in UDIG</strong></p>
<p>StyleBlackboard extends IBlackboard. StyleBlackboard interface has the &#64;model declaration and is
therefore part of the EMF model. However IBlackboard is not part of the Model (does not have the
&#64;model declaration). In this situation the EMF Generator will complain that &#8220;supertype IBlackboard
cannot be resolved&#8221;; this is because it is not part of the model as a EClass. To fix this error the
following must be added to the Package interface:</p>
<p><strong>ProjectPackage.java</strong></p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm">* @model instanceClass=&quot;org.locationtech.udig.project.IBlackboard&quot;</span>
<span class="cm">*/</span>
<span class="n">EClass</span> <span class="nf">getIBlackboard</span><span class="o">();</span>
</pre></div>
</div>
<p>Once this line is part of the Package declaration IBlackboard is considered to have an EClass and
the model will load and be generated correctly.</p>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="fonts_and_imagery.html">Fonts and Imagery</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="guide_to_miglayout.html">Guide to MigLayout</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2013, Refractions Research and others.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>